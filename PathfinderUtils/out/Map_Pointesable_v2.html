<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<title>Pointesable</title>
	<link rel="stylesheet" type="text/css" href="./scripts/Bootstrap/bootstrap.min.css">
	<link rel="stylesheet" type="text/css" href="./scripts/tippy/tippy.css">
	<link rel="stylesheet" type="text/css" href="./scripts/tippy/themes/light.css">
	<link rel="stylesheet" type="text/css" href="./scripts/jquery-ui/jquery-ui.min.css">
	<style>
	html { overflow-y: scroll; }
	body { background-color:#CCCCCC; }
	
	area { cursor: pointer; }
	
	.hilightMult {
		width: 1.5em;
		float: left; 
		text-align: center; 
		font-weight: bold;
		cursor: default;
		-moz-user-select: none; /* Firefox */
		-ms-user-select: none; /* Internet Explorer */
		-khtml-user-select: none; /* KHTML browsers (e.g. Konqueror) */
		-webkit-user-select: none; /* Chrome, Safari, and Opera */
		-webkit-touch-callout: none; /* Disable Android and iOS callouts*/
		user-select: none;
	}
	.hilightlink { color: #000000; }
	.hilightlink:hover { color: #000000; }
	
	.categspirituel { background-color: #FFFF60; border-color: #000000; }
	.categtaverne { background-color: #ff1010; border-color: #000000; }
	.categcommerce { background-color: #ffbfff; border-color: #000000; }
	.categdivers { background-color: #80FFFF; border-color: #000000; }
	.categadministration { background-color: #80FF10; border-color: #000000; }
	.categindustrie { background-color: #554CFF; border-color: #000000; }
	
	.categspecial { background-color: #4B0082; border-color: #ff0000; 
	color: #FFFFFF;
	}
	
	
	.mapButton { -moz-box-shadow:inset 0px 1px 0px 0px #a6827e; -webkit-box-shadow:inset 0px 1px 0px 0px #a6827e; box-shadow:inset 0px 1px 0px 0px #a6827e; background:-webkit-gradient(linear, left top, left bottom, color-stop(0.05, #7d5d3b), color-stop(1, #634b30)); background:-moz-linear-gradient(top, #7d5d3b 5%, #634b30 100%); background:-webkit-linear-gradient(top, #7d5d3b 5%, #634b30 100%); background:-o-linear-gradient(top, #7d5d3b 5%, #634b30 100%); background:-ms-linear-gradient(top, #7d5d3b 5%, #634b30 100%); background:linear-gradient(to bottom, #7d5d3b 5%, #634b30 100%); filter:progid:DXImageTransform.Microsoft.gradient(startColorstr='#7d5d3b', endColorstr='#634b30',GradientType=0); background-color:#7d5d3b; -moz-border-radius:3px; -webkit-border-radius:3px; border-radius:3px; border:1px solid #54381e; display:inline-block; color:#ffffff; padding:4px 24px; text-decoration:none; text-shadow:0px 1px 0px #4d3534; cursor: pointer; }
	.mapButton:hover { background:-webkit-gradient(linear, left top, left bottom, color-stop(0.05, #634b30), color-stop(1, #7d5d3b)); background:-moz-linear-gradient(top, #634b30 5%, #7d5d3b 100%); background:-webkit-linear-gradient(top, #634b30 5%, #7d5d3b 100%); background:-o-linear-gradient(top, #634b30 5%, #7d5d3b 100%); background:-ms-linear-gradient(top, #634b30 5%, #7d5d3b 100%); background:linear-gradient(to bottom, #634b30 5%, #7d5d3b 100%); filter:progid:DXImageTransform.Microsoft.gradient(startColorstr='#634b30', endColorstr='#7d5d3b',GradientType=0); background-color:#634b30; }
	.mapButton:active { position:relative; top:1px; }
	
	.mapButtonV2 {
		font-size: .9em;
		text-align: center;
	}
	.switchMapButton { 
		width: 9em;
		height: 2em;
	}
	.littleButton {
		width: 2em;
		height: 2em;
	}
	
	#moveListes {
		cursor: move;
	}
	
	div#blockMap {
		display: inline-block;
	}
	div#blockList {
		font-size: 12px;
		position: fixed;
		left: 853px;
		top: 0px;
		white-space:nowrap;
	}
	div#boutons {
		font-size: 1.1em;
		margin: .4em .4em .4em .4em;
		text-align: left;
		
		-moz-user-select: none; /* Firefox */
		-ms-user-select: none; /* Internet Explorer */
		-khtml-user-select: none; /* KHTML browsers (e.g. Konqueror) */
		-webkit-user-select: none; /* Chrome, Safari, and Opera */
		-webkit-touch-callout: none; /* Disable Android and iOS callouts*/
		user-select: none;
	}
	div#listes {
		background-color: #FCFFE5;
		//padding: 5px 5px 5px 5px;
		padding: .1em .4em .4em .4em;
	}
	div#slider-range {
		margin: 1em 1.5em .5em 1.5em; 
	}
	div.slide-handle {
		font-size: 1.4em;
		margin-top: -.3em;
		text-align: center;
		line-height: 1.1em;
	}
	div#liste1 {
		display: inline-block;
		vertical-align: bottom;
		padding-right: .4em;
	}
	div#liste2 {
		display: inline-block;
		vertical-align:bottom;
	}
	</style>
</head>
<body>


<div id="blockMap">
<img id="mapPathfinder" class="map" src="Pointesable.jpg" width="853" height="1113" usemap="#world">
<map id="map1" name="world"></map>
<map id="map2" name="world"></map>
</div>

<div id="blockList">
<div id="boutons">
<span id="moveListes" class="mapButton mapButtonV2 littleButton">&#8644;</span>&nbsp;<span id="hideShowListes" class="mapButton mapButtonV2 littleButton">&#9651;</span>&nbsp;<span id="buttonChangeMap" class="mapButton mapButtonV2 switchMapButton">switch map</span>&nbsp;<span id="test" class="mapButton mapButtonV2 littleButton">&#127775;</span>
</div>

<div id="listes">
<div id="slider-range"><div id="slide-handle-min" class="ui-slider-handle slide-handle"></div><div id="slide-handle-max" class="ui-slider-handle slide-handle"></div></div>
<div id="tabs">
  <ul>
    <li><a href="#tabs-1" style="font-size:.8em">De base</a></li>
    <li><a href="#tabs-2" style="font-size:.8em">Rencontres</a></li>
    <li><a href="#tabs-3" style="font-size:.8em">Combats</a></li>
  </ul>
<div id="tabs-1">
<div id="liste1"></div>
<div id="liste2"></div>
</div>
<div id="tabs-2">
</div>
<div id="tabs-3">
</div>
</div>
</div>

</div>



<!--
<area id="path4559sssds" class="areabis areaspecial" shape="poly" coords="462, 639, 465, 648, 471, 645, 468, 651, 477, 654, 468, 657, 471, 663, 465, 660, 462, 669, 459, 660, 453, 663, 456, 657, 447, 654, 456, 651, 453, 645, 459, 648" >
-->
<span class="categspecial" hidden></span>

<script type="text/javascript" src="./scripts/jquery-3.3.1.min.js"></script>
<script type="text/javascript" src="./scripts/maphilight/jquery.maphilight.min.js"></script>
<script src="./scripts/tippy/tippy.all.min.js"></script>
<script src="./scripts/Bootstrap/bootstrap.min.js"></script>
<script src="./scripts/bootbox/bootbox.min.js"></script>
<script src="./scripts/jquery-ui/jquery-ui.min.js"></script>
<script src="./scripts/jquery-csv/jquery.csv.min.js"></script>
<script src="./functions.js"></script>
<script type="text/javascript">
//Initialisation de la page


//Idees : 
// Mettre des tabs jquery-ui

//Slider 
$( function() {
	$('#slider-range').slider({
		orientation: 'horizontal', //'vertical',
		range: true,
		min: 0, 
		max: 6,
		values: [ 0, 6 ],
		create: function() {
			$('#slide-handle-min').text( $( this ).slider('values')[0] );
			$('#slide-handle-max').text( $( this ).slider('values')[1] );
		},
		slide: function( event, ui ) {
			//console.log (ui.values[0] + " - " + ui.values[1]);
			$('#slide-handle-min').text( ui.values[0] );
			$('#slide-handle-max').text( ui.values[1] );
		}
	});
	//$( "#amount" ).val( "$" + $( "#slider-range" ).slider( "values", 0 ) + " - $" + $( "#slider-range" ).slider( "values", 1 ) );
} );
//--------------------

//tabs
$( function() {
	$( "#tabs" ).tabs({
		//collapsible: true
	});
} );
//----------------












$(function() {
	//var cheminCSV = 'http://127.0.0.1/PathfinderUtils';
	var cheminCSV = '.';
	
	//activation des couleurs de fond par dÃ©faut
	$('#mapPathfinder').attr('data-areabisactive', true);
	//---------------
	
	
	$.get(cheminCSV + '/csv/map1.csv', function(content) {
		var data = $.csv.toObjects(content, {separator:',', delimiter:'"', onParseValue: $.csv.hooks.castToScalar});
		
		data.sort(function(a,b) {
			if ( a.categorie > b.categorie )
				return 1;
			if ( b.categorie > a.categorie )
				return -1;
			if ( a.numero > b.numero)
				return 1;
			if ( b.numero > a.numero )
				return -1
			return 0;
		}); 
		
		
		$('#map1').empty();
		$('#map2').empty();
		$('#liste1').empty();
		$('#liste2').empty();
		
		var map1 = '';
		var map2 = '';
		var liste = '';
		for(var row in data) {
			//"areaid","shape","coords","categorie","numero","titre","description"
			//console.log(data[row].categorie + '   ' + data[row].numero);
			map1 = '<area id="' + data[row].areaid + '" ';
			map1 += 'class="area" shape="' + data[row].shape + '" ';
			map1 += 'coords="' + data[row].coords + '" ';
			map1 += 'data-categorie="' + data[row].categorie + '" ';
			
			map1 += 'data-numero="' + data[row].numero + '" ';
			map1 += 'data-titre="' + data[row].titre + '" ';
			map1 += 'data-message="' + data[row].description + '" ';
			
			map1 += 'title="' + data[row].numero + ' - <b>' + data[row].titre + '</b>" ';
			map1 += '/>\n';
			
			
			map2 = '<area id="' + data[row].areaid + 'bis" ';
			map2 += 'class="areabis" shape="' + data[row].shape + '" ';
			map2 += 'coords="' + data[row].coords + '" ';
			map2 += 'data-categorie="' + data[row].categorie + '" ';
			map2 += '/>\n';
			
			
			liste = '<span class="hilightMult categ' + data[row].categorie + '" ';
			liste += 'data-categorie="' + data[row].categorie + '">' + data[row].categorie.substr(0, 1).toUpperCase() + '</span>&nbsp;';
			liste += '<a class="hilightlink" data-areaid="' + data[row].areaid + '" ';
			liste += 'data-categorie="' + data[row].categorie + '" href="#">';
			liste += data[row].titre + ' (' + data[row].numero + ')</a><br/>';
			
			//
			
			
			$('#map1').append(map1);
			$('#map2').append(map2);
			if ( row < data.length/2 )
				$('#liste1').append(liste);
			else
				$('#liste2').append(liste);
			
			row++;
		}
		
		liste = '<span class="hilightMult categspecial" ';
		liste += 'data-categorie="special">&#127775;</span>&nbsp;';
		liste += '<a class="hilightlink" ';
		liste += 'data-categorie="special" href="#">';
		liste += '&#129414;&#129414;&#129414;&#129414;&#129414;&#129414;coincoin</a><br/>';
		$('#liste2').append(liste);
		initMap();
		
	}, 'text');
	
	
});

var addStar = false;
$('#test').click(function(e) {
	addStar = !addStar;
	if ( addStar )
		$(this).html('&#129414;');
	else
		$(this).html('&#127775;');
	
	e.preventDefault();
});

$('#blockMap').click(function(e) {
	if ( addStar && e.pageX < 1000 )
	{
		addStar = false;
		$('#test').html('&#127775;');
		
		//$('#map1').append('<area data-categorie="special" id="toto" title="coincoin" class="area" shape="poly" coords="462, 639, 465, 648, 471, 645, 468, 651, 477, 654, 468, 657, 471, 663, 465, 660, 462, 669, 459, 660, 453, 663, 456, 657, 447, 654, 456, 651, 453, 645, 459, 648" />');
		//$('#map2').append('<area data-categorie="special" id="totobis" class="areabis" shape="poly" coords="462, 639, 465, 648, 471, 645, 468, 651, 477, 654, 468, 657, 471, 663, 465, 660, 462, 669, 459, 660, 453, 663, 456, 657, 447, 654, 456, 651, 453, 645, 459, 648" />');
		
		var coordStar = giveMeAStar(e.pageX, e.pageY);
		
		var data = {areaid:"toto", shape:"poly", coords:coordStar, categorie:"special"};
		
		var map1 = '';
		var map2 = '';
		//"areaid","shape","coords","categorie","numero","titre","description"
		//console.log(data[row].categorie + '   ' + data[row].numero);
		map1 += '<area id="' + data.areaid + '" ';
		map1 += 'class="area" shape="' + data.shape + '" ';
		map1 += 'coords="' + data.coords + '" ';
		map1 += 'data-categorie="' + data.categorie + '" ';
		
		/*map1 += 'data-numero="' + data[row].numero + '" ';
		map1 += 'data-titre="' + data[row].titre + '" ';
		map1 += 'data-message="' + data[row].description + '" ';
		*/
		map1 += 'title="' + /*data[row].numero + ' - <b>' + data[row].titre*/'coincoin' + '</b>" ';
		map1 += '/>\n';
		
		
		map2 += '<area id="' + data.areaid + 'bis" ';
		map2 += 'class="areabis" shape="' + data.shape + '" ';
		map2 += 'coords="' + data.coords + '" ';
		map2 += 'data-categorie="' + data.categorie + '" ';
		map2 += '/>\n';
		
		$('#map1').append(map1);
		$('#map2').append(map2);
		initMap();
	}
});

function giveMeAStar(x, y)
{
	//int[] etoileV0 = {20, 0, 24, 16, 40, 20, 24, 24, 20, 40, 16, 24, 0, 20, 16, 16};
	//int[] etoileV1 = {5, 0, 6, 4, 10, 5, 6, 6, 5, 10, 4, 6, 0, 5, 4, 4};
	//int[] etoileV2 = {5,0, 6, 3, 8, 2, 7, 4, 10, 5, 7, 6, 8, 8, 6, 7,           5, 10, 4, 7, 2, 8, 3, 6, 0, 5, 3, 4, 2, 2, 4, 3};
	var etoile = [5,0, 6, 3, 8, 2, 7, 4, 10, 5, 7, 6, 8, 8, 6, 7,           5, 10, 4, 7, 2, 8, 3, 6, 0, 5, 3, 4, 2, 2, 4, 3];

	var coords = '';
	var largeur = 3;
	
	for ( var i in etoile )
		coords += (i>0?", ":"") + ((etoile[i] - 5)*largeur + (i%2==0?x:y));
	
	return coords;
}

//------ fin de l'initialisation --------
</script>

</body>
</html>